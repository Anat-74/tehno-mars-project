import{p as C,u as q,q as I,B as s}from"./C6S7ryDZ.js";const h=C("cart",()=>{const{currentLocale:c}=q(),a=I([]),u=s(()=>a.value.reduce((t,e)=>t+e.quantity,0)),l=s(()=>a.value.reduce((t,e)=>t+e.product.price*e.quantity,0)),d=(t,e,n)=>{var i;const r=a.value.find(g=>g.product.id===t.id),v=typeof t.image=="string"?t.image:Array.isArray(t.image)&&((i=t.image[0])==null?void 0:i.url)||"";r?r.quantity+=1:a.value.push({product:{...t,image:v,categorySlug:e,subcategorySlug:n,originalLocale:c.value},quantity:1}),o()},m=t=>{a.value=a.value.filter(e=>e.product.id!==t),o()},f=(t,e)=>{const n=a.value.find(r=>r.product.id===t);if(n){const r=Math.max(1,e);n.quantity=r,o()}},y=()=>{a.value=[],o()},o=()=>{localStorage.setItem("cart",JSON.stringify(a.value))},p=t=>t&&typeof t.quantity=="number"&&t.product&&typeof t.product.id=="number";return{items:a,totalItems:u,totalPrice:l,addToCart:d,removeFromCart:m,updateQuantity:f,clearCart:y,loadCart:()=>{if(typeof window>"u")return;const t=localStorage.getItem("cart");if(t)try{const e=JSON.parse(t);Array.isArray(e)&&(a.value=e.filter(p))}catch(e){console.error("Ошибка загрузки:",e),localStorage.removeItem("cart")}}}});export{h as u};
